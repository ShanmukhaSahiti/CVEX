---
- name: Install the exploit for Spring4Shell Vulnerability（CVE-2022-22965）
  hosts: all
  become: yes
  tasks:
    - name: Update apt package index
      apt:
        update_cache: yes
        
    - name: Install a list of packages
      ansible.builtin.apt:
        pkg:
        - python3-pip

    - name: Create /opt/spring4shell
      file:
        path: /opt/spring4shell
        state: directory

    - name: Clone spring4shell
      git:
        repo: https://github.com/lunasec-io/Spring4Shell-POC.git
        dest: /opt/spring4shell
        version: "master"
        update: yes

    - name: Install packages required for spring4shell
      ansible.builtin.shell:
        cmd: pip3 install requests
        chdir: /opt/spring4shell
